#!/bin/bash

if [ -f "$PWD/tmp/test" ]; then
  $PWD/tmp/test $@
else
  if [ -d $PWD/spec ]; then
    framework=rspec
  else
    framework=minitest

    if [ "$@" ]; then
      files=$@
    else
      files="test/**/*_test.rb"
    fi
  fi

  if [ -S .zeus.sock ]; then
    zeus test $@
  elif which -s spring; then
    if [ $framework == rspec ]; then
      spring rspec $@
    else
      sprint testunit $files
    fi
  else
    if [ $framework == rspec ]; then
      rspec $@
    else
      ruby -Ilib -Itest $files
    fi
  fi
fi
